<script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
MathJax.Ajax.config.path["mhchem"] =
  "https://cdnjs.cloudflare.com/ajax/libs/mathjax-mhchem/3.3.2";
MathJax.Hub.Config({
  TeX: {
    extensions: ["[mhchem]/mhchem.js"]
  }
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

# Alkalinity and pH simulator

Contains functions to determine total alkalinity from pH (or rather, hydrogen ion concentration), and the reverse.

Total alkalinity ($A_\text{T}$) was defined by Dickson (1981) as:

$$A_\text{T} = \ce{HCO3- + 2CO3^2- + B(OH)4- + OH- - H+ - HSO4- - HF}$$

$$\ce{- H3PO4 + HPO4^2- + 2PO4^3- + Si(OH)3O-}$$

The [stoichiometric dissociation constant](../dissoc/) for each component equilibrium can be used to substitute the individual ionic concentrations in the equation above for functions of the [total concentration of each species](../conc/) and the hydrogen ion concentration.

<hr />

## `.AT`: alkalinity from pH

Determines alkalinity from pH and a set of total concentrations and stoichiometric dissociation constants using the equation above.

**Syntax:**

```python
AT, ATcomponents = calk.sim.AT(H, mu, *XT, *KX)
```

**Inputs:**

  * `H`: hydrogen ion concentration in mol·kg-sw<sup>−1</sup>;
  * `mu`: acid dilution factor;
  * `XT`: list of total concentrations (as generated by [conc.XT](../conc/#xt-list-of-concentrations));
  * `KX`: list of stoichiometric dissociation constants (as generated by [dissoc.KX_F](../dissoc/#kx_f-list-of-constants)).

**Outputs:**

  * `AT`: total alkalinity in mol·kg-sw<sup>−1</sup>;
  * `ATcomponents`: list of concentrations of alkalinity components, in the order:
    * $+[\ce{HCO3-}]$, $+2[\ce{CO3^2-}]$, $+[\ce{B(OH)4-}]$, $+[\ce{OH-}]$, $-[\ce{H+}]$, $-[\ce{HSO4-}]$, $-[\ce{HF}]$, $-[\ce{H3PO4}]$, $+[\ce{HPO4^2-}]$, $+2[\ce{PO4^3-}]$, $+[\ce{Si(OH)3O-}]$.

<hr />

## `.H`: pH from alkalinity

Determines pH from alkalinity, a given amount of acid addition, and a set of total concentrations and stoichiometric dissociation constants using the equation above.

**Syntax:**

```python
H = calk.sim.H(Macid, Msamp, Cacid, XT, KX)
```

**Inputs:**

  * `Macid`: acid mass in kg;
  * `Msamp`: sample mass in kg;
  * `Cacid`: acid concentration in mol·kg-H<sub>2</sub>O<sup>−1</sup>;
  * `XT`: list of total concentrations (as generated by [conc.XT](../conc/#xt-list-of-concentrations));
  * `KX`: list of stoichiometric dissociation constants (as generated by [dissoc.KX_F](../dissoc/#kx_f-list-of-constants)).

**Output:**

  * `H`: hydrogen ion concentration in mol·kg-sw<sup>−1</sup>.
