<script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
MathJax.Ajax.config.path["mhchem"] =
  "https://cdnjs.cloudflare.com/ajax/libs/mathjax-mhchem/3.3.2";
MathJax.Hub.Config({TeX: {extensions: ["[mhchem]/mhchem.js"]}});
</script><script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

# Equilibrium constants

The [alkalinity solvers](../solvers) need values for the stoichiometric dissociation constant for each equilibrium that is active over the titration pH range in order to solve for alkalinity.  These are collated in a dict called `eqConstants`, to conveniently pass this information into the solver functions. The dict can be generated using the function of the same name in the `dissociation` module, or you can assemble your own manually.

All stoichiometric equilibrium constants are on the Free pH scale (as defined by [ZW01](../references/#ZW01)), and are valid only at a pressure of ~1 atm, unless otherwise specified.

---

## `eqConstants`: dict of equilibrium constants

Assembles a dict of equilibrium constants on the Free pH scale, as required by other Calkulate functions.

**Syntax:**

```python
eqConstants = calk.dissociation.eqConstants(tempK, psal, concTotals)
```

The `concTotals` dict input, generated by the function of the same name in the `concentrations` module (see [Total concentrations](../concentrations)), must contain at least the total sulfate and fluoride concentrations, which are required to convert all the equilibrium constants to the Free pH scale.

The output `eqConstants` dict contains the following constants, for dissociation of:

```python
concTotals = {
    'B': <boric acid>,
    'C1': <first carbonic acid>,
    'C2': <second carbonic acid>,
    'F': <hydrofluoric acid>,
    'P1': <first phosphoric acid>,
    'P2': <second phosphoric acid>,
    'P3': <third phosphoric acid>,
    'S': <bisulfate ion>,
    'Si': <orthosilicic acid>,
}
```

The stoichiometric dissociation constants can be manually defined, or evaluated using the other functions in the `dissociation` module, which are as follows.

---

## Estimates from temperature and salinity

The functions available in the `dissociation` module to estimate total concentrations from temperature and practical salinity all follow the same syntax:

```python
kEq = calk.dissociation.kEq_SCALE_REF(tempK, pSal)
```

The different options for `Eq`, `SCALE` and `REF` (i.e. [literature reference](../references)) are listed below. The value marked as 'default' is the one used by the `eqConstants` function.

The `SCALE` component indicates the pH scale (as defined by [ZW01](../references/#ZW01)) that the constant is defined on: `F` for Free scale, `T` for Total scale, `S` for Seawater scale, and `U` where the scale is unknown.

For solutes with multiphase equilibria, the `k` at the start of the function name is replaced by `ks`, and all of the relevant constants are returned as a tuple.

### `H2CO3`: carbonic acid

After dissolving into seawater, $\ce{CO2}$ reacts to form carbonic acid ($\ce{H2CO3}$), which totally dissociates into bicarbonate and carbonate ions ($\ce{HCO3-}$ and $\ce{CO3^2-}$). The relevant equilibria are:

$$\ce{CO2(aq) + H2O <=>[$K_1$] HCO3- + H+}$$

$$\ce{HCO3- <=>[$K_2$] CO3^2- + H+}$$

with the stoichiometric dissociation constants:

$$K_1^\* = \frac{[\ce{HCO3-}] [\ce{H+}]}{[\ce{CO2(aq)}]}$$

$$K_2^\* = \frac{[\ce{CO3^2-}] [\ce{H+}]}{[\ce{HCO3-}]}$$

**Options:**

  * `ksH2CO3_T_LDK00`: Lueker et al., 2000 [[LDK00](../references/#LDK00)] (default):
    * Valid: 2 < temperature < 35 °C; 19 < salinity < 43.

### `BOH3`: boric acid

The equilibrium reaction is:

$$\ce{B(OH)3 + H2O <=>[$K_\text{B}$] B(OH)4- + H+}$$

with the stoichiometric dissociation constant:

$$K_\text{B}^\* = \frac{[\ce{B(OH)4-}] [\ce{H+}]}{[\ce{B(OH)3}]}$$

**Options:**

  *  `kBOH3_T_D90a`: Dickson, 1990a [[D90a](../references/#D90a)] (default).
    * Valid: 0 < temperature < 45 °C; 5 < salinity < 45.

### `H2O`: water

The equilibrium reaction is:

$$\ce{H2O <=>[$K_\text{w}$] OH- + H+}$$

with the stoichiometric dissociation constant:

$$K_\text{w}^\* = [\ce{OH-}] [\ce{H+}]$$

**Options:**

  * `kH2O_T_DSC07`: Dickson et al., 2007 [[DSC07](../references/#DSC07)] (default).

### `HSO4`: bisulfate

The equilibrium reaction is:

$$\ce{HSO4- <=>[$K_\text{S}$] SO4^2- + H+}$$

with the stoichiometric dissociation constant:

$$K_\text{S}^\* = \frac{[\ce{SO4^2-}] [\ce{H+}]}{[\ce{HSO4-}]}$$

**Options:**

  * `.kHSO4_F_D90b`: Dickson, 1990b [[D90b](../references/#D90b)] (default):
    * Valid: 0 < temperature < 45 °C; 5 < salinity < 45.

### `HF`: hydrofluoric acid

The equilibrium reaction is:

$$\ce{HF <=>[$K_\text{HF}$] F- + H+}$$

with the stoichiometric dissociation constant:

$$K_\text{HF}^\* = \frac{[\ce{F-}] [\ce{H+}]}{[\ce{HF}]}$$

**Options:**

  * `kHF_F_DR79`: Dickson and Riley, 1979 [[DR79](../references/#DR79)]:
    * Valid: 5 < temperature < 35 °C; 10 < salinity < 48.
  * `kHF_T_PF87`: Perez and Fraga, 1987 [[PF87](../references/#PF87)] (default):
    * Valid: 9 < temperature < 33 °C; 10 < salinity < 40.

### `H3PO4`: phosphoric acid

The equilibrium reactions are:

$$\ce{H3PO4 <=>[$K_\text{P1}$] H2PO4- + H+}$$

$$\ce{H2PO4- <=>[$K_\text{P2}$] HPO4^2- + H+}$$

$$\ce{HPO4^2- <=>[$K_\text{P3}$] PO4^3- + H+}$$

with the stoichiometric dissociation constants:

$$K_\text{P1}^\* = \frac{[\ce{H2PO4-}] [\ce{H+}]}{[\ce{H3PO4}]}$$

$$K_\text{P2}^\* = \frac{[\ce{HPO4^2-}] [\ce{H+}]}{[\ce{H2PO4-}]}$$

$$K_\text{P3}^\* = \frac{[\ce{PO4^3-}] [\ce{H+}]}{[\ce{HPO4^2-}]}$$

**Options:**

  * `ksH3PO4_T_DSC07 `: Dickson et al., 2007 [[DSC07](../references/#DSC07)] (default).

### `SiOH3`: orthosilicic acid

The equilibrium reaction is:

$$\ce{Si(OH)4 <=>[$K_\text{Si}$] Si(OH)3O- + H+}$$

with the stoichiometric dissociation constant:

$$K_\text{Si}^\* = \frac{[\ce{Si(OH)3O-}] [\ce{H+}]}{[\ce{Si(OH)4}]}$$

**Options:**

  * `kSiOH3_T_M95`: Millero, 1995 [[M95](../references/#M95)] (default).

<!--

# Ammonium

The equilibrium reaction is:

$$\ce{NH3 <=>[$K_\text{Si}$] Si(OH)3O- + H+}$$

with the stoichiometric dissociation constant:

$$K_\text{Si}^\* = \frac{[\ce{Si(OH)3O-}] [\ce{H+}]}{[\ce{Si(OH)4}]}$$

## .KNH4_X_BJJL08 - ammonium

Estimates the ammonium stoichiometric dissociation constant from temperature and salinity on **an unknown** pH scale following Bell et al. (2008).

**Syntax:**

```python
KNH4 = calk.dissociation.KNH4_X_BJJL08(tempK, psal)
```

**Inputs:**

  * `tempK` - temperature in K;
  * `psal` - practical salinity.

**Outputs:**

  * `KNH4` - dissociation constant for ammonium on **an unknown** pH scale in mol·kg-sw<sup>−1</sup>.


## .K2AMP_S_BE86 - 2-aminopyridine

Estimates the 2-aminopyridine stoichiometric dissociation constant from temperature and salinity on the seawater pH scale following Bates and Erickson (1986). Valid for temperature from 5 to 40 °C and practical salinity from 30 to 40.

**Syntax:**

```python
K2AMP = calk.dissociation.K2AMP_S_BE86(tempK, psal)
```

**Inputs:**

  * `tempK` - temperature in K;
  * `psal` - practical salinity.

**Outputs:**

  * `K2AMP` - dissociation constant for 2-aminopyridine on the seawater pH scale in mol·kg-sw<sup>−1</sup>.

-->
